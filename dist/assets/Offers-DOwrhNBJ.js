import{j as e,i as j}from"./framer-O_qyKole.js";import{r as b}from"./react-Bjzu39jn.js";import{f as y,g as C,t as N,M as P,h as v,C as D,n as m,i as S,j as q,P as M}from"./index-5Z8Lvhuy.js";import{c as O}from"./zustand-MWJfmZmr.js";import{d as U,f as k,e as R,i as $}from"./ui--o9aqPNp.js";import"./tanstack-cynJ2YVG.js";import"./trpc-DBeWMeKD.js";import"./utils-m6CwOAsu.js";import"./recharts-Decb_PJ4.js";import"./reactHookForm-6EQnDOt0.js";import"./validation-DXqQCM1T.js";const z=()=>{const{setCurrentPage:c,currentPage:o}=y(),[n,a]=b.useState(""),p=C(n),{data:d,isLoading:l}=N.offershop.find.useQuery({currentPage:o,active:!0,orderBy:"desc",sizePage:20,productDescription:p});return{rows:(d==null?void 0:d.offers)||[],totalPages:(d==null?void 0:d.totalPages)||1,isLoading:l,currentPage:o,setCurrentPage:c,setProductDescription:a}},f=O()(c=>({modal:!1,products:[],updateProduct:o=>c(n=>({products:[...n.products.filter(a=>a.id!==o.id),o]})),onModal:o=>c(()=>({modal:o})),onProduct:o=>c(n=>({products:n.products.some(p=>p.id===o.id)?n.products:[...n.products,{...o,qt:1}]})),rmProduct:o=>c(n=>({products:[...n.products.filter(a=>a.id!==o)]}))})),g=()=>e.jsx("svg",{fill:"currentColor",viewBox:"0 0 20 20",className:"h-4 w-4 text-yellow-400",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9.049 2.927c.3-.916 1.603-.916 1.902 0l1.286 3.953a1.5 1.5 0 001.421 1.033h4.171c.949 0 1.341 1.154.577 1.715l-3.38 2.458a1.5 1.5 0 00-.54 1.659l1.286 3.953c.3.916-.757 1.67-1.539 1.145l-3.38-2.458a1.5 1.5 0 00-1.76 0l-3.38 2.458c-.782.525-1.838-.229-1.539-1.145l1.286-3.953a1.5 1.5 0 00-.54-1.659l-3.38-2.458c-.764-.561-.372-1.715.577-1.715h4.171a1.5 1.5 0 001.421-1.033l1.286-3.953z"})}),A=({id:c})=>{const o=f(l=>l.products),n=f(l=>l.updateProduct),a=o.find(l=>l.id===c),p=()=>{n({...a,qt:((a==null?void 0:a.qt)??1)+1})},d=()=>{n({...a,qt:a.qt&&a.qt>1?a.qt-1:a.qt})};return e.jsxs("div",{className:"absolute -left-12",children:[e.jsx("p",{className:"text-4xl",children:a.qt}),e.jsxs("div",{className:"flex flex-col pt-2 gap-4",children:[e.jsx("button",{type:"button",className:"bg-neutral-500 rounded-md p-1 shadow-xl shadow-neutral-400",onClick:p,children:"+1"}),e.jsx("button",{type:"button",className:"bg-neutral-500 rounded-md p-1 shadow-xl shadow-neutral-400",onClick:d,children:"-1"})]})]})},F=c=>{const{id:o,cost:n,currency:a,description:p,picture:d}=c,l=f(r=>r.products),[u,t]=f(r=>[r.onProduct,r.rmProduct]),i=(r,w)=>{w.offset.x>50?u(c):w.offset.x<-50&&t(o)},x=()=>{u(c)},h=()=>{t(o)},s=b.useMemo(()=>!!l.find(r=>r.id===o),[l]);return e.jsxs(j.section,{drag:"x",dragConstraints:{left:0,right:0},dragElastic:.2,whileDrag:{scale:1.1},animate:{x:s?50:0,transition:{type:"spring",stiffness:300,damping:20}},onDragEnd:i,className:U("relative bg-neutral-800 grid grid-cols-2 gap-3 p-2 rounded-2xl -z-0",s?"border-4 border-blue-500":""),children:[e.jsx("button",{type:"button",className:"absolute text-2xl text-blue-300 right-0 z-50",onClick:x,children:e.jsx(P,{})}),s&&e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:"absolute text-3xl text-red-300 lefth-0 top-0 bg-neutral-800 rounded-lg z-50",onClick:h,children:e.jsx(v,{})}),e.jsx(A,{id:o})]}),e.jsx(D,{width:300,picture:d,onImage:!0}),e.jsxs("div",{className:"flex flex-col justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[1.4rem]",children:p}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(g,{},Math.random()*1e6),e.jsx(g,{},Math.random()*1e6),e.jsx(g,{},Math.random()*1e6),e.jsx(g,{},Math.random()*1e6),e.jsx(g,{},Math.random()*1e6)]})]}),e.jsx("p",{className:"text-[1.6rem] font-semibold",children:m(n,a)})]})]})},I=({count:c})=>{function o(t,i){const x=t.replace(/[^\d]/g,""),h=encodeURIComponent(i),s=`https://wa.me/${x}?text=${h}`;window.open(s,"_blank","noopener,noreferrer")}const n=f(t=>t.products),a=n.filter(t=>t.currency==="USD").reduce((t,i)=>t+parseFloat(i.cost)*((i==null?void 0:i.qt)??1),0),p=n.filter(t=>t.currency==="CUP").reduce((t,i)=>t+parseFloat(i.cost)*((i==null?void 0:i.qt)??1),0);function d(t){const i=((t==null?void 0:t.qt)??1)*parseFloat(t.cost);return`${t.description} (${m(t.cost,t.currency)} x ${t.qt}):
${m(i,t.currency)}`}function l(t,i){const x=i.map(d).join(`
`);return`Total a pagar USD: ${m(t,"USD")},
${p>0?"Total a pagar CUP: "+m(p,"CUP"):""}
 ${x}`}const u=()=>{o("5358014257",l(a,n))};return e.jsxs("div",{className:"relative bg-white px-4 py-2 rounded-full",onClick:u,children:[e.jsx("p",{className:"absolute -top-4 text-2xl -right-1 bg-red-600 text-white p-2 rounded-full",children:c}),e.jsx(S,{className:"text-5xl"})]})},E=({onAction:c})=>e.jsxs("header",{className:"pt-2 pb-5 flex flex-col items-center justify-center bg-black",children:[e.jsx(k,{className:"m-5",isBlurred:!0,width:340,src:"./icon-george-removebg-preview.png"}),e.jsx(R,{onClick:c,variant:"shadow",color:"primary",className:"w-[255px]",radius:"sm",endContent:e.jsx(q,{className:"text-2xl"}),children:"Buscar producto"})]}),X=()=>{const{rows:c,setProductDescription:o,setCurrentPage:n,currentPage:a,totalPages:p}=z(),[d,l]=b.useState(!1),u=f(s=>s.products),t=u.reduce((s,r)=>s+((r==null?void 0:r.qt)??1),0),i=u.filter(s=>s.currency==="CUP").reduce((s,r)=>s+parseFloat(r.cost)*((r==null?void 0:r.qt)??1),0),x=u.filter(s=>s.currency==="USD").reduce((s,r)=>s+parseFloat(r.cost)*((r==null?void 0:r.qt)??1),0),h=t>0;return e.jsxs("section",{className:"bg-black min-h-screen overflow-auto",children:[e.jsx(j.div,{style:{willChange:"top"},initial:{top:0},transition:{duration:.5,ease:"easeOut"},animate:{top:d?"-18rem":0,position:"fixed"},className:"fixed left-0 right-0 top-0 z-10",children:e.jsx(E,{onAction:()=>l(!d)})}),e.jsx(j.div,{initial:{top:"-4rem"},transition:{duration:.6,ease:"easeInOut"},animate:{top:d?"0.5rem":"-4rem",position:"fixed"},className:"fixed left-1 right-1 -top-16 z-10",children:e.jsx($,{label:"Producto...",radius:"sm",size:"lg",color:"primary",variant:"faded",onValueChange:o})}),e.jsxs(j.div,{initial:{paddingTop:"16rem"},transition:{duration:.5,ease:"easeInOut"},animate:{paddingTop:d?"6rem":"16rem"},className:"text-white p-5 flex flex-col gap-5 mb-24",children:[c.map(s=>e.jsx(F,{id:s.id,cost:s.cost,currency:s.currency,description:`${s.product.description}`,picture:s.product.picture??""},s.id)),e.jsx(M,{setCurrentPage:n,currentPage:a,totalPages:p})]}),e.jsx(j.footer,{initial:{bottom:"-6rem"},transition:{duration:.5,ease:"easeInOut"},animate:{bottom:h?"1rem":"-6rem"},className:"fixed z-40 bottom-4 right-4",children:e.jsxs("div",{className:"flex gap-5 items-end",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[x>0&&e.jsx("p",{className:"opacity-90 text-3xl font-semibold bg-primary text-white p-2 rounded-md",children:m(x,"USD")}),i>0&&e.jsx("p",{className:"opacity-90 text-3xl font-semibold bg-primary text-white p-2 rounded-md",children:m(i,"CUP")})]}),e.jsx(I,{count:t})]})})]})};export{X as default};
